---
title: "Negative Incentive Framing Structures in Cognitively Demanding Tasks"
author: "Tshering Wangchuk and Franco Salinas Meza"
output: github_document
bibliography: Library.bib
---

```{r include=FALSE}
knitr::opts_chunk$set(echo = FALSE, error = TRUE, warning = FALSE, message = FALSE)

library(dplyr)
library(tidyr)
library(lubridate)
library(stringr)
library(ggplot2)
library(sf)
library(spdep)
library(spatialreg)
```

```{r, results='hide'}
experiment<- read.csv('Data.csv')
data<-as.data.frame(experiment)
data_clean<- data %>% 
  filter(SL<30) %>% 
  select(-X,-X.1) 
```

```{r}

data_clean %>% 
  filter(School_Year == 1)

##Given the low number of first years we could create two variables, one that it lower and upper classmen 

data_clean<-data_clean %>% 
  mutate(school_status = ifelse(test = School_Year == 1|School_Year==2, yes = "Underclassmen",no = "Upperclassmen"))


data_clean %>% 
  count(Major)

NEW_MAJOR_CATEGORY<-data_clean %>% 
  mutate(Major_category = ifelse(Major=="Biology"|Major=="Computer Science"|Major=="Geology"|Major=="Neuroscience"|Major=="Statistics","Stem","Social Science")) %>% 
  mutate(accuracy_rate = Correct/12, share_questions_responded = (Passage.1+Passage.2)/12)

NEW_MAJOR_CATEGORY %>% 
  ggplot(aes(x = Major_category,y = accuracy_rate))+
  geom_boxplot()

NEW_MAJOR_CATEGORY %>% 
  ggplot(aes(x = accuracy_rate, y = factor(school_status)))+
  geom_boxplot()

##Maybe Group as Social Sciences, STEM. 
NEW_MAJOR_CATEGORY %>% 
  ggplot(aes(x = accuracy_rate, y = factor(Major)))+
  geom_boxplot()



NEW_MAJOR_CATEGORY %>% 
  ggplot(aes(x = accuracy_rate, y = factor(English_Native)))+
  geom_boxplot()

NEW_MAJOR_CATEGORY %>% 
  ggplot(aes(y = accuracy_rate, x = factor(Incentive_Structure)))+
  geom_boxplot()

NEW_MAJOR_CATEGORY %>% 
  ggplot(aes(x = accuracy_rate, y = factor(International)))+
  geom_boxplot()


NEW_MAJOR_CATEGORY %>% 
  ggplot(aes(x = accuracy_rate, y = Guess))+
  geom_point()+
  geom_smooth()

NEW_MAJOR_CATEGORY %>% 
  ggplot(aes(x = accuracy_rate, y = Hours_of_Sleep))+
  geom_point()+
  geom_smooth()

NEW_MAJOR_CATEGORY %>% 
  ggplot(aes(x = accuracy_rate, y = Number_of_Classes))+
  geom_point()+
  geom_smooth()

NEW_MAJOR_CATEGORY %>% 
  ggplot(aes(x = accuracy_rate, y = Workload))+
  geom_boxplot()

NEW_MAJOR_CATEGORY %>% 
  ggplot(aes(x = accuracy_rate, y = Gender))+
  geom_boxplot()

NEW_MAJOR_CATEGORY %>% 
  ggplot(aes(y = share_questions_responded, x = Incentive_Structure))+
  geom_boxplot()

NEW_MAJOR_CATEGORY %>% 
  ggplot(aes(x = share_questions_responded))+
  geom_density()+
  



NEW_MAJOR_CATEGORY %>% 
  filter(Major == "Political Science")


model1 <- lm(accuracy_rate~Incentive_Structure+Gender+factor(school_status)+English_Native+Number_of_Classes+Hours_of_Sleep+Workload+Major_category+share_questions_responded,data = NEW_MAJOR_CATEGORY)
summary(model1)
model2<-lm(share_questions_responded~Incentive_Structure+Gender+factor(school_status)+English_Native+Number_of_Classes+Hours_of_Sleep+Workload+Major_category+share_questions_responded,data = NEW_MAJOR_CATEGORY)
summary(model2)

```

