---
title: "Negative Incentive Framing Structures in Cognitively Demanding Tasks"
author: "Tshering Wangchuk and Franco Salinas Meza"
output: github_document
bibliography: Library.bib
---

```{r include=FALSE}
knitr::opts_chunk$set(echo = FALSE, error = TRUE, warning = FALSE, message = FALSE)

library(dplyr)
library(tidyr)
library(lubridate)
library(stringr)
library(ggplot2)
library(sf)
library(spdep)
library(spatialreg)
```

```{r, results='hide'}
experiment<- read.csv('Data.csv')
data<-as.data.frame(experiment)
data_clean<- data %>% 
  filter(SL<30) %>% 
  select(-X,-X.1) 
```

```{r}

data_clean %>% 
  filter(School_Year == 1)

##Given the low number of first years we could create two variables, one that it lower and upper classmen 

data_clean<-data_clean %>% 
  mutate(school_status = ifelse(test = School_Year == 1|School_Year==2, yes = "Underclassmen",no = "Upperclassmen"))

data_clean %>% 
  ggplot(aes(x = Correct, y = factor(school_status)))+
  geom_boxplot()

##Maybe Group as Social Sciences, STEM. 
data_clean %>% 
  ggplot(aes(x = Correct, y = factor(Major)))+
  geom_boxplot()



data_clean %>% 
  ggplot(aes(x = Correct, y = factor(English_Native)))+
  geom_boxplot()

data_clean %>% 
  ggplot(aes(x = Correct, y = factor(Incentive_Structure)))+
  geom_boxplot()

data_clean %>% 
  ggplot(aes(x = Correct, y = factor(International)))+
  geom_boxplot()


data_clean %>% 
  ggplot(aes(x = Correct, y = Guess))+
  geom_point()+
  geom_smooth()

data_clean %>% 
  ggplot(aes(x = Correct, y = Hours_of_Sleep))+
  geom_point()+
  geom_smooth()

data_clean %>% 
  ggplot(aes(x = Correct, y = Number_of_Classes))+
  geom_point()+
  geom_smooth()

data_clean %>% 
  ggplot(aes(x = Correct, y = Workload))+
  geom_boxplot()

data_clean %>% 
  ggplot(aes(x = Correct, y = Gender))+
  geom_boxplot()




data_clean %>% 
  filter(Major == "Political Science")


data_clean %>% 
  count(Major)

NEW_MAJOR_CATEGORY<-data_clean %>% 
  mutate(Major_category = ifelse(Major=="Biology"|Major=="Computer Science"|Major=="Geology"|Major=="Neuroscience"|Major=="Statistics","Stem","Social Science")) 

NEW_MAJOR_CATEGORY %>% 
  ggplot(aes(x = Major_category,y = Correct))+
  geom_boxplot()


lm(Correct~Gender+factor(school_status)+English_Native ,data = data_clean)
```

